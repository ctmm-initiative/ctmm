<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calculate model fit residuals and assess their autocorrelation — residuals.ctmm â€¢ ctmm</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">ctmm</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/variogram.html">Variograms and Model Selection</a>
    </li>
    <li>
      <a href="../articles/akde.html">Autocorrelated Kernel Density Estimation</a>
    </li>
    <li>
      <a href="../articles/periodogram.html">Periodograms and Periodicities</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ctmm-initiative/ctmm">
    <span class="fa fa-github fa-2x"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate model fit residuals and assess their autocorrelation</h1>
    </div>

    
    <p>These functions calculate the residuals of a CTMM model, which should be standardized and IID if the model correctly specified.
A correlogram method is also provided to assess remaining autocorrelation.
This function is analogous to <code>acf</code>, but can handle missing data and multiple dimensions.</p>
    

    <pre class="usage"><span class='co'># S3 method for ctmm</span>
<span class='fu'>residuals</span>(<span class='no'>object</span>,<span class='no'>data</span>,<span class='no'>...</span>)

<span class='co'># S3 method for telemetry</span>
<span class='fu'>residuals</span>(<span class='no'>object</span>,<span class='no'>CTMM</span>,<span class='no'>...</span>)

<span class='fu'>correlogram</span>(<span class='no'>data</span>,<span class='kw'>dt</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>fast</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>res</span><span class='kw'>=</span><span class='fl'>1</span>,<span class='kw'>axes</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"x"</span>,<span class='st'>"y"</span>))</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p><code>ctmm</code> model object or <code>telemetry</code> data object for calculating residuals.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p><code>telemetry</code> data object or <code>data.frame</code> with time column <code>t</code> and data columns <code>axes</code>.</p></td>
    </tr>
    <tr>
      <th>CTMM</th>
      <td><p><code>ctmm</code> model object.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Unused arguments.</p></td>
    </tr>
    <tr>
      <th>dt</th>
      <td><p>Lag bin width. An ordered array will yield a progressive coarsening of the lags. Defaults to the median sampling interval.</p></td>
    </tr>
    <tr>
      <th>fast</th>
      <td><p>Use the lag-weighted algorithm if <code>FALSE</code> or the FFT algorithm if <code>TRUE</code>. The slow algorithm outputs a progress bar.</p></td>
    </tr>
    <tr>
      <th>res</th>
      <td><p>Increase the discretization resolution for irregularly sampled data with <code>res&gt;1</code>. Decreases bias at the cost of smoothness.</p></td>
    </tr>
    <tr>
      <th>axes</th>
      <td><p>Array of axes to calculate an average (isotropic) correlogram for.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Given a <code>telemetry</code> dataset and <code>ctmm</code> model, <code>residuals</code> calculates the standardized residuals of the Kalman filter, which can be tested for independence. The residuals object can then be plotted with <code>plot</code> or fed into the <code>correlogram</code> method to test independence. Output of the correlogram can then be plotted as well, though <code>zoom</code> is much more useful.</p>
<p>When calculating correlograms, minimizing bias is more important than producing a overall smooth estimate. If <code>fast=TRUE</code>, then <code>res</code> needs to be large enough to resolve variability in the sampling interval (missing data is permitted). E.g., if the sampling interval is set to 15 minutes, but can be off by a minute or two, then <code>res=15</code> is a good choice.</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>residuals</code> return a residual object (class <code>telemetry</code>, but flagged as residual) and <code>correlogram</code> returns a correlogram object (class <code>variogram</code>, but flagged as an ACF).</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>C. H. Fleming, D. Sheldon, E. Gurarie, W. F. Fagan, S. LaPoint, J. M. Calabrese.
Kálmán filters for continuous-time movement models.
<a href='http://www.sciencedirect.com/science/article/pii/S1574954117301115'>Ecological Informatics, 40, 8-21 (2017)</a>.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>If the sampling schedule is irregular, permitting gaps, then the correlogram may not look good even if the model is correctly specified. In this case the correlogram of the residuals should be compared to the correlogram of simulated residuals, using "data" simulated from the fit model and with the same sampling schedule.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='plot.variogram.html'>plot.variogram</a></code>, <code><a href='variogram.html'>variogram</a></code>.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>#Load package and data</span>
<span class='fu'>library</span>(<span class='no'>ctmm</span>)
<span class='fu'>data</span>(<span class='no'>buffalo</span>)
<span class='no'>Cilla</span> <span class='kw'>&lt;-</span> <span class='no'>buffalo</span>$<span class='no'>Cilla</span>

<span class='co'>#fit a model</span>
<span class='no'>GUESS</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='variogram.fit.html'>ctmm.guess</a></span>(<span class='no'>Cilla</span>,<span class='kw'>interactive</span><span class='kw'>=</span><span class='fl'>FALSE</span>)
<span class='no'>FIT</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='ctmm.fit.html'>ctmm.fit</a></span>(<span class='no'>Cilla</span>,<span class='no'>GUESS</span>)

<span class='co'>#calculate residuals</span>
<span class='no'>RES</span> <span class='kw'>&lt;-</span> <span class='fu'>residuals</span>(<span class='no'>Cilla</span>,<span class='no'>FIT</span>)

<span class='co'>#scatter plot of residuals</span>
<span class='fu'><a href='plot.telemetry.html'>plot</a></span>(<span class='no'>RES</span>)</div><div class='img'><img src='residuals-1.png' alt='' width='700' height='432.632880098887' /></div><div class='input'>
<span class='co'>#calculate correlogram of residuals</span>
<span class='co'># increase the res argument to account for sampling variability</span>
<span class='no'>ACF</span> <span class='kw'>&lt;-</span> <span class='fu'>correlogram</span>(<span class='no'>RES</span>,<span class='kw'>res</span><span class='kw'>=</span><span class='fl'>10</span>)

<span class='co'>#plot a day's worth of lags</span>
<span class='fu'><a href='plot.telemetry.html'>plot</a></span>(<span class='no'>ACF</span>[<span class='no'>ACF</span>$<span class='no'>lag</span><span class='kw'>&lt;=</span><span class='fl'>1</span> <span class='kw'>%#%</span> <span class='st'>'day'</span>,],<span class='kw'>fraction</span><span class='kw'>=</span><span class='fl'>1</span>)</div><div class='img'><img src='residuals-2.png' alt='' width='700' height='432.632880098887' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
     C. H. Fleming
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Christen H. Fleming, Justin M. Calabrese.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
