<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pairwise interactions • ctmm</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Pairwise interactions">
<meta property="og:description" content="ctmm">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ctmm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/variogram.html">Variograms and Model Selection</a>
    </li>
    <li>
      <a href="../articles/akde.html">Autocorrelated Kernel Density Estimation</a>
    </li>
    <li>
      <a href="../articles/error.html">Telemetry Error</a>
    </li>
    <li>
      <a href="../articles/interactions.html">Encounters and Interactions</a>
    </li>
    <li>
      <a href="../articles/periodogram.html">Periodograms and Periodicities</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ctmm-initiative/ctmm" class="external-link">
    <span class="fa fa-github fa-2x"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Pairwise interactions</h1>
                        <h4 data-toc-skip class="author">Michael J. Noonan and Christen H. Fleming</h4>
            
            <h4 data-toc-skip class="date">2023-09-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ctmm-initiative/ctmm/blob/HEAD/vignettes/interactions.Rmd" class="external-link"><code>vignettes/interactions.Rmd</code></a></small>
      <div class="hidden name"><code>interactions.Rmd</code></div>

    </div>

    
    
<hr>
<p>This vignette details methods that can be used for studying interactions between individuals from location data. The metrics described in this vignette include:</p>
<ul>
<li>Home-range overlap</li>
<li>Conditional Distribution of Encounters (CDE)</li>
<li>Pairwise distances</li>
<li>Proximity ratios</li>
<li>Encounter rates</li>
</ul>
<p>We will assume that you have already an understanding of how to fit <code>ctmm</code> movement models to your tracking data (see <code><a href="../articles/variogram.html">vignette("variogram")</a></code>), as well as how to estimate home-range areas (see <code><a href="../articles/akde.html">vignette("akde")</a></code>). Here we will use the buffalo data in our examples.</p>
<div class="section level2">
<h2 id="home-range-overlap">Home-range overlap<a class="anchor" aria-label="anchor" href="#home-range-overlap"></a>
</h2>
<p>Home-range overlap describes the extent to which a pair of individuals share the same space. Overlap is typically quantified by the first-estimating home ranges from tracking data and then applying an overlap metric to the range estimates. The default overlap estimator in <code>ctmm</code> is a bias-corrected version of the Bhattacharyya coefficient ().</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ctmm-initiative/ctmm" class="external-link">ctmm</a></span><span class="op">)</span> <span class="co">#load the package</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"buffalo"</span><span class="op">)</span> <span class="co">#import the data</span></span>
<span><span class="fu"><a href="../reference/projection.html">projection</a></span><span class="op">(</span><span class="va">buffalo</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/projection.html">median</a></span><span class="op">(</span><span class="va">buffalo</span><span class="op">)</span> <span class="co"># reproject the data</span></span>
<span></span>
<span><span class="co"># Fit the movement models to the tracking data</span></span>
<span><span class="va">FITS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">buffalo</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">GUESS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/variogram.fit.html">ctmm.guess</a></span><span class="op">(</span><span class="va">buffalo</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,interactive<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">FITS</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ctmm.fit.html">ctmm.select</a></span><span class="op">(</span><span class="va">buffalo</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,<span class="va">GUESS</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">FITS</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">buffalo</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calculate AKDES on a consistent grid</span></span>
<span><span class="va">AKDES</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/akde.html">akde</a></span><span class="op">(</span><span class="va">buffalo</span>,<span class="va">FITS</span>,weights<span class="op">=</span><span class="cn">TRUE</span>,dt.plot<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>With the fitted models and estimated home-range areas in hand, the next step is to estimate the Bhattacharyya coefficient using the <code><a href="../reference/overlap.html">overlap()</a></code> function.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">OVER</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/overlap.html">overlap</a></span><span class="op">(</span><span class="va">AKDES</span><span class="op">)</span></span></code></pre></div>
<p>The overlap function returns an object of class <code>overlap</code>, which is a list with elements <code>DOF</code> and <code>CI</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">OVER</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "overlap"</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">OVER</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "DOF" "CI"</span></span></code></pre>
<p>The <code>DOF</code> slot contains information on the degrees of freedom of each estimated overlap value, whereas the <code>CI</code> slot contains the estimated overlap values and their confidence intervals.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">OVER</span><span class="op">$</span><span class="va">CI</span></span></code></pre></div>
<pre><code><span><span class="co">## , , low</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##               Cilla         Gabs        Mvubu       Pepper        Queen</span></span>
<span><span class="co">## Cilla  1.000000e+00 8.974219e-01 9.510518e-01 7.971138e-10 4.769027e-11</span></span>
<span><span class="co">## Gabs   8.974219e-01 1.000000e+00 8.543964e-01 9.264102e-10 6.491430e-11</span></span>
<span><span class="co">## Mvubu  9.510518e-01 8.543964e-01 1.000000e+00 1.208349e-09 7.312016e-11</span></span>
<span><span class="co">## Pepper 7.971138e-10 9.264102e-10 1.208349e-09 1.000000e+00 3.596742e-01</span></span>
<span><span class="co">## Queen  4.769027e-11 6.491430e-11 7.312016e-11 3.596742e-01 1.000000e+00</span></span>
<span><span class="co">## Toni   4.414511e-23 3.456152e-23 2.159934e-22 3.197930e-01 9.371314e-03</span></span>
<span><span class="co">##                Toni</span></span>
<span><span class="co">## Cilla  4.414511e-23</span></span>
<span><span class="co">## Gabs   3.456152e-23</span></span>
<span><span class="co">## Mvubu  2.159934e-22</span></span>
<span><span class="co">## Pepper 3.197930e-01</span></span>
<span><span class="co">## Queen  9.371314e-03</span></span>
<span><span class="co">## Toni   1.000000e+00</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## , , est</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##               Cilla         Gabs        Mvubu       Pepper        Queen</span></span>
<span><span class="co">## Cilla  1.000000e+00 9.976234e-01 9.974721e-01 8.371554e-07 2.823166e-07</span></span>
<span><span class="co">## Gabs   9.976234e-01 1.000000e+00 9.914584e-01 5.288795e-06 8.648153e-06</span></span>
<span><span class="co">## Mvubu  9.974721e-01 9.914584e-01 1.000000e+00 1.275752e-06 4.989072e-07</span></span>
<span><span class="co">## Pepper 8.371554e-07 5.288795e-06 1.275752e-06 1.000000e+00 6.490225e-01</span></span>
<span><span class="co">## Queen  2.823166e-07 8.648153e-06 4.989072e-07 6.490225e-01 1.000000e+00</span></span>
<span><span class="co">## Toni   1.244679e-16 4.773284e-12 1.146514e-15 5.556637e-01 6.540082e-02</span></span>
<span><span class="co">##                Toni</span></span>
<span><span class="co">## Cilla  1.244679e-16</span></span>
<span><span class="co">## Gabs   4.773284e-12</span></span>
<span><span class="co">## Mvubu  1.146514e-15</span></span>
<span><span class="co">## Pepper 5.556637e-01</span></span>
<span><span class="co">## Queen  6.540082e-02</span></span>
<span><span class="co">## Toni   1.000000e+00</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## , , high</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##               Cilla        Gabs        Mvubu       Pepper        Queen</span></span>
<span><span class="co">## Cilla  1.000000e+00 1.000000000 1.000000e+00 0.0002191542 0.0002363162</span></span>
<span><span class="co">## Gabs   1.000000e+00 1.000000000 1.000000e+00 0.0030145139 0.0192125915</span></span>
<span><span class="co">## Mvubu  1.000000e+00 1.000000000 1.000000e+00 0.0003234070 0.0004263494</span></span>
<span><span class="co">## Pepper 2.191542e-04 0.003014514 3.234070e-04 1.0000000000 0.9099836997</span></span>
<span><span class="co">## Queen  2.363162e-04 0.019212592 4.263494e-04 0.9099836997 1.0000000000</span></span>
<span><span class="co">## Toni   2.879705e-11 0.000107714 3.531767e-10 0.8051233270 0.2719415948</span></span>
<span><span class="co">##                Toni</span></span>
<span><span class="co">## Cilla  2.879705e-11</span></span>
<span><span class="co">## Gabs   1.077140e-04</span></span>
<span><span class="co">## Mvubu  3.531767e-10</span></span>
<span><span class="co">## Pepper 8.051233e-01</span></span>
<span><span class="co">## Queen  2.719416e-01</span></span>
<span><span class="co">## Toni   1.000000e+00</span></span></code></pre>
<p>Because the Bhattacharyya coefficient is a symmetric measure of overlap (ranging from 0-1), the resulting matrix is also symmetric. If you’re interested in extracting the matrix of the point estimates, they are stored in the <code>est</code> slot of the <code>CI</code> slot.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">OVER</span><span class="op">$</span><span class="va">CI</span><span class="op">[</span>,,<span class="st">"est"</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##               Cilla         Gabs        Mvubu       Pepper        Queen</span></span>
<span><span class="co">## Cilla  1.000000e+00 9.976234e-01 9.974721e-01 8.371554e-07 2.823166e-07</span></span>
<span><span class="co">## Gabs   9.976234e-01 1.000000e+00 9.914584e-01 5.288795e-06 8.648153e-06</span></span>
<span><span class="co">## Mvubu  9.974721e-01 9.914584e-01 1.000000e+00 1.275752e-06 4.989072e-07</span></span>
<span><span class="co">## Pepper 8.371554e-07 5.288795e-06 1.275752e-06 1.000000e+00 6.490225e-01</span></span>
<span><span class="co">## Queen  2.823166e-07 8.648153e-06 4.989072e-07 6.490225e-01 1.000000e+00</span></span>
<span><span class="co">## Toni   1.244679e-16 4.773284e-12 1.146514e-15 5.556637e-01 6.540082e-02</span></span>
<span><span class="co">##                Toni</span></span>
<span><span class="co">## Cilla  1.244679e-16</span></span>
<span><span class="co">## Gabs   4.773284e-12</span></span>
<span><span class="co">## Mvubu  1.146514e-15</span></span>
<span><span class="co">## Pepper 5.556637e-01</span></span>
<span><span class="co">## Queen  6.540082e-02</span></span>
<span><span class="co">## Toni   1.000000e+00</span></span></code></pre>
<p>Alternatively, if you’re interested in extracting overlap values for specific pairs, they can easily be pulled out of the <code>overlap</code> object either by row/column names, or by their numerical indices.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># pairwise CIs </span></span>
<span><span class="va">OVER</span><span class="op">$</span><span class="va">CI</span><span class="op">[</span><span class="st">"Pepper"</span>,<span class="st">"Toni"</span>,<span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##       low       est      high </span></span>
<span><span class="co">## 0.3197930 0.5556637 0.8051233</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">OVER</span><span class="op">$</span><span class="va">CI</span><span class="op">[</span><span class="st">"Queen"</span>,<span class="st">"Toni"</span>,<span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##         low         est        high </span></span>
<span><span class="co">## 0.009371314 0.065400820 0.271941595</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="conditional-distribution-of-encounters-cde">Conditional Distribution of Encounters (CDE)<a class="anchor" aria-label="anchor" href="#conditional-distribution-of-encounters-cde"></a>
</h2>
<p>The home range—a spatially dependent PDF—describes an animal’s long-run space use. Home-range overlap (a single number) describes the potential for interactions to occur. In contrast, the Conditional Distribution of Encounters (CDE) is a spatially defined PDF that describes the long-term encounter location probabilities for movement within home ranges. For additional information, see the relevant paper: , or the help file <code><a href="../reference/encounter.html">help("encounter")</a></code>.</p>
<p>We will work with Pepper and Queen, and start by plotting their tracking data and home-range estimates.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.telemetry.html">plot</a></span><span class="op">(</span><span class="va">buffalo</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Pepper"</span>, <span class="st">"Queen"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>     UD<span class="op">=</span><span class="va">AKDES</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Pepper"</span>, <span class="st">"Queen"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>     col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#e76f51"</span>, <span class="st">"#264653"</span><span class="op">)</span>,</span>
<span>     col.DF<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#f4a261"</span>, <span class="st">"#2a9d8f"</span><span class="op">)</span>,</span>
<span>     col.grid <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## DOP values missing. Assuming DOP=1.</span></span>
<span><span class="co">## DOP values missing. Assuming DOP=1.</span></span></code></pre>
<p><img src="interactions_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>Visually, we can see that there is a decent amount of overlap between these two animals. The overlap estimate confirms this.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">OVER</span><span class="op">$</span><span class="va">CI</span><span class="op">[</span><span class="st">"Pepper"</span>,<span class="st">"Queen"</span>,<span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##       low       est      high </span></span>
<span><span class="co">## 0.3596742 0.6490225 0.9099837</span></span></code></pre>
<p>This overlap suggests a reasonably strong potential for these animals to encounter one another, but this then begs the question of where might these two individuals meet? Under the assumption that an encounter were to occur, the CDE provides an answer to this question. this is estimated by applying the <code><a href="../reference/encounter.html">cde()</a></code> function on a list of AKDE home range estimates.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CDE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/encounter.html">cde</a></span><span class="op">(</span><span class="va">AKDES</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Pepper"</span>, <span class="st">"Queen"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Visualise the CDE</span></span>
<span><span class="fu"><a href="../reference/plot.telemetry.html">plot</a></span><span class="op">(</span><span class="va">buffalo</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Pepper"</span>, <span class="st">"Queen"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>     col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#e76f51"</span>, <span class="st">"#264653"</span><span class="op">)</span>,</span>
<span>     UD<span class="op">=</span><span class="va">CDE</span>,</span>
<span>     col.DF<span class="op">=</span><span class="st">"#046C9A"</span>,</span>
<span>     col.grid <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## DOP values missing. Assuming DOP=1.</span></span>
<span><span class="co">## DOP values missing. Assuming DOP=1.</span></span></code></pre>
<p><img src="interactions_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>As a note, because the CDE is estimated directly from the home-ranges areas, any bias in the home-range estimates is propagated to the estimated CDE.</p>
</div>
<div class="section level2">
<h2 id="pairwise-distances">Pairwise distances<a class="anchor" aria-label="anchor" href="#pairwise-distances"></a>
</h2>
<p>Here we will work with Pepper and Queen, and again start by plotting their tracking data and home-range estimates.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.telemetry.html">plot</a></span><span class="op">(</span><span class="va">buffalo</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Cilla"</span>, <span class="st">"Mvubu"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>     UD<span class="op">=</span><span class="va">AKDES</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Cilla"</span>, <span class="st">"Mvubu"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>     col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#e76f51"</span>, <span class="st">"#264653"</span><span class="op">)</span>,</span>
<span>     col.DF<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#f4a261"</span>, <span class="st">"#2a9d8f"</span><span class="op">)</span>,</span>
<span>     col.grid <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## DOP values missing. Assuming DOP=1.</span></span>
<span><span class="co">## DOP values missing. Assuming DOP=1.</span></span></code></pre>
<p><img src="interactions_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>We can see substantial overlap between these two individuals, so we know they share the same space, but we don’t know to what extent they tend to share the same space at the same time (the overlap estimates described above provide no information on spatiotemporal overlap). Pairwise separation distances are a good place to start for understanding if pairs of individuals are attracted to, or avoid, one another. From a pair of tracks (class <code>telemetry</code>) and model-fit objects (class <code>ctmm</code>), pairwise distances can be estimated in <code>ctmm</code> using the <code><a href="../reference/difference.html">distances()</a></code> function.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">DISTS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/difference.html">distances</a></span><span class="op">(</span><span class="va">buffalo</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Cilla"</span>,<span class="st">"Mvubu"</span><span class="op">)</span><span class="op">]</span>,<span class="va">FITS</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Cilla"</span>,<span class="st">"Mvubu"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>This function returns a <code>data.frame</code> that contains the estimated separation distances, the confidence intervals on the estimates, and the timestamps.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/as.telemetry.html">head</a></span><span class="op">(</span><span class="va">DISTS</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          low      est      high          t           timestamp</span></span>
<span><span class="co">## 1 1927.72822 2060.694 2195.8120 1121403720 2005-07-15 05:02:00</span></span>
<span><span class="co">## 2   41.71841  212.107  450.1718 1121405640 2005-07-15 05:34:00</span></span>
<span><span class="co">## 3 4230.05054 4445.083 4662.7132 1121409300 2005-07-15 06:35:00</span></span>
<span><span class="co">## 4 4827.70160 4958.439 5090.0318 1121410920 2005-07-15 07:02:00</span></span>
<span><span class="co">## 5 3929.21369 4066.184 4204.3028 1121412840 2005-07-15 07:34:00</span></span>
<span><span class="co">## 6 3153.48461 3289.111 3426.1316 1121414520 2005-07-15 08:02:00</span></span></code></pre>
<p>Visualising the separation distances over time can then provide information on how these individuals tend to interact over time.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.telemetry.html">plot</a></span><span class="op">(</span><span class="va">DISTS</span><span class="op">$</span><span class="va">est</span> <span class="op">~</span> <span class="va">DISTS</span><span class="op">$</span><span class="va">timestamp</span>,</span>
<span>     type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"#5e548e"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Separation distance (m)"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<p><img src="interactions_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>Here we see that although the mean separation distance is 3577.4861416(m) there were three distinct periods where Cilla and Mvubu were extremely close to one another, versus four periods where they drifted apart.</p>
<p>Separation distances can provide useful descriptions of the behaviour of pairs of animals, but are these distances meaningful? Or, seen another way, what are they saying about Cilla and Mvubu’s relationship? Are they actively staying close to one another? Are they avoiding one another? Or are these just the result of independent movement? Answering these questions requires something that we can compare the observed separation distances against. With the distance estimates alone, we don’t have a null model to compare against, but we can generate one via simulation (see <code><a href="../reference/simulate.ctmm.html">help("simulate")</a></code>).</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cilla_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate.ctmm.html">simulate</a></span><span class="op">(</span><span class="va">FITS</span><span class="op">$</span><span class="va">Cilla</span>,t<span class="op">=</span><span class="va">buffalo</span><span class="op">$</span><span class="va">Cilla</span><span class="op">$</span><span class="va">t</span><span class="op">)</span></span>
<span><span class="va">mvubu_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate.ctmm.html">simulate</a></span><span class="op">(</span><span class="va">FITS</span><span class="op">$</span><span class="va">Mvubu</span>,t<span class="op">=</span><span class="va">buffalo</span><span class="op">$</span><span class="va">Mvubu</span><span class="op">$</span><span class="va">t</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim_dists</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/difference.html">distances</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">cilla_sim</span>, <span class="va">mvubu_sim</span><span class="op">)</span>,<span class="va">FITS</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Cilla"</span>,<span class="st">"Mvubu"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot.telemetry.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">cilla_sim</span>, <span class="va">mvubu_sim</span><span class="op">)</span>,</span>
<span>     col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#e76f51"</span>, <span class="st">"#264653"</span><span class="op">)</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Simulated data"</span><span class="op">)</span></span></code></pre></div>
<p><img src="interactions_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.telemetry.html">plot</a></span><span class="op">(</span><span class="va">sim_dists</span><span class="op">$</span><span class="va">est</span> <span class="op">~</span> <span class="va">sim_dists</span><span class="op">$</span><span class="va">timestamp</span>,</span>
<span>     type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"#5e548e"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Simulated distances"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Distance (m)"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Time"</span>,</span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">sim_dists</span><span class="op">$</span><span class="va">est</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="interactions_files/figure-html/unnamed-chunk-14-2.png" width="700"></p>
<p>This suggests that Cilla and Mvubu are closer together than one might expect from completely random movement (particularly during certain times of the year). But this conclusion is based off of only one simulated track, which is only one of an infinitely large number of potential paths the animal could have taken. Ideally, you would repeat this process many, many times to obtain an average. The <code><a href="../reference/difference.html">proximity()</a></code> function calculates this (note: this function can be slow).</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PROXIMITY</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/difference.html">proximity</a></span><span class="op">(</span><span class="va">buffalo</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Cilla"</span>,<span class="st">"Mvubu"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                       <span class="va">FITS</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Cilla"</span>,<span class="st">"Mvubu"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                       GUESS <span class="op">=</span> <span class="fu"><a href="../reference/ctmm.fit.html">ctmm</a></span><span class="op">(</span>error<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="co">#this is to speed up the calculation</span></span>
<span></span>
<span><span class="va">PROXIMITY</span></span></code></pre></div>
<pre><code><span><span class="co">##       low       est      high </span></span>
<span><span class="co">## 0.2336587 0.3972563 0.6333218</span></span></code></pre>
<p><code><a href="../reference/difference.html">proximity()</a></code> outputs a ratio estimate with confidence intervals, where values &lt;1 indicate that the two individuals are closer on average than expected for independent movement, 1 is consistent with independent movement, and values &gt;1 indicate that the individuals are farther from each other on average than expected for independent movement. Therefore, if the CIs contain 1, then the distance is insignificant with a p-value threshold of 1-level (two-sided) or half that for a one-sided test.</p>
</div>
<div class="section level2">
<h2 id="encounter-rates">Encounter rates<a class="anchor" aria-label="anchor" href="#encounter-rates"></a>
</h2>
<p>Often, a core reason for tracking animals is to attempt to link individual behaviour with higher-level ecological processes. For many processes (disease transmission dynamics, mating, predator-prey dynamics), this is governed by how individuals’ movement behaviour translates to encounter rates. The observed separation distances contain information on the number of encounter events (and by extension encounter rates). We can get at this fairly simply by defining an encounter radius. For an example of this type of analysis in action see: . Here we can arbitrarily define an encounter event between Cilla and Mvubu as when they were within 100m of one another.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">DISTS</span><span class="op">$</span><span class="va">encounter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">DISTS</span><span class="op">$</span><span class="va">est</span> <span class="op">&lt;=</span> <span class="fl">100</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p>We can visualise this to get a feeling for when and how often they encountered one another over the sampling period.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.telemetry.html">plot</a></span><span class="op">(</span><span class="va">DISTS</span><span class="op">$</span><span class="va">encounter</span> <span class="op">~</span> <span class="va">DISTS</span><span class="op">$</span><span class="va">timestamp</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">"Encounter"</span>, main <span class="op">=</span> <span class="st">"Scatter plot"</span><span class="op">)</span></span></code></pre></div>
<p><img src="interactions_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<p>From this we can also estimate how many times Cilla and Mvubu encountered one another during the sampling period, or, alternatively, their encounter rate.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">DISTS</span><span class="op">$</span><span class="va">encounter</span><span class="op">)</span></span>
<span><span class="va">t</span> <span class="op">&lt;-</span> <span class="st">"day"</span> <span class="op"><a href="../reference/unit.html">%#%</a></span> <span class="op">(</span><span class="va">DISTS</span><span class="op">$</span><span class="va">t</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">DISTS</span><span class="op">)</span><span class="op">]</span> <span class="op">-</span> <span class="va">DISTS</span><span class="op">$</span><span class="va">t</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"There were an estimated "</span>, <span class="va">n</span>, <span class="st">" encounters between Cilla and Mvubu, and their encounter rate was "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">n</span><span class="op">/</span><span class="va">t</span>,<span class="fl">2</span><span class="op">)</span>, <span class="st">" per day."</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## There were an estimated  829  encounters between Cilla and Mvubu, and their encounter rate was  7.78  per day.</span></span></code></pre>
<p>The choice of 100m is arbitrary, however, so if you are interested in applying such an analysis, it is recommended that you perform a sensitivity analysis on the value of this radius.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">enc_rad</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">1000</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"numeric"</span>, <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">enc_rad</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">N</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">DISTS</span><span class="op">$</span><span class="va">est</span> <span class="op">&lt;=</span> <span class="va">enc_rad</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#visualise the results</span></span>
<span><span class="fu"><a href="../reference/plot.telemetry.html">plot</a></span><span class="op">(</span><span class="va">N</span> <span class="op">~</span> <span class="va">enc_rad</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Encounters"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Encounter radius (m)"</span>,</span>
<span>     type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"#5e548e"</span><span class="op">)</span></span></code></pre></div>
<p><img src="interactions_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
<p>As an additional caveat, if a pair of individuals encounter one another, a single encounter event may persist for some time. Depending on how finely sampled the data may be, there is thus the potential for double counting encounter events (or more). Care should therefore be taken when performing such an analysis.</p>
<p>Another metric of encounter rates is available from the <code><a href="../reference/encounter.html">encounter()</a></code> function, which estimates the <strong>relative</strong> encounter rates between individuals.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">RATES</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/encounter.html">encounter</a></span><span class="op">(</span><span class="va">AKDES</span><span class="op">)</span></span></code></pre></div>
<p>This is an overlap class object with all of the same structure as defined above. Looking at the points estimates we can see these relative encounter rates.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">RATES</span><span class="op">$</span><span class="va">CI</span><span class="op">[</span>,,<span class="st">"est"</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##               Cilla         Gabs        Mvubu       Pepper        Queen</span></span>
<span><span class="co">## Cilla           Inf 1.013833e-08 1.217934e-08 0.000000e+00 0.000000e+00</span></span>
<span><span class="co">## Gabs   1.013833e-08          Inf 9.782347e-09 0.000000e+00 0.000000e+00</span></span>
<span><span class="co">## Mvubu  1.217934e-08 9.782347e-09          Inf 0.000000e+00 0.000000e+00</span></span>
<span><span class="co">## Pepper 0.000000e+00 0.000000e+00 0.000000e+00          Inf 3.273059e-09</span></span>
<span><span class="co">## Queen  0.000000e+00 0.000000e+00 0.000000e+00 3.273059e-09          Inf</span></span>
<span><span class="co">## Toni   0.000000e+00 0.000000e+00 0.000000e+00 2.087975e-09 3.071601e-11</span></span>
<span><span class="co">##                Toni</span></span>
<span><span class="co">## Cilla  0.000000e+00</span></span>
<span><span class="co">## Gabs   0.000000e+00</span></span>
<span><span class="co">## Mvubu  0.000000e+00</span></span>
<span><span class="co">## Pepper 2.087975e-09</span></span>
<span><span class="co">## Queen  3.071601e-11</span></span>
<span><span class="co">## Toni            Inf</span></span></code></pre>
<p>From this matrix we can see that Cilla and Mvubu tend to encounter to one another ca. three times as often at Toni and Pepper. Note: these are unitless measures of encounter rates.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Christen H. Fleming, Justin M. Calabrese.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
